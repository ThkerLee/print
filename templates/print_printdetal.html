<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0　Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<html>
<head>
	<title>Welcome NexERP</title>
	<link rel="stylesheet" type="text/css" href="{{static_url("print.css")}}">
	<script type="text/javascript" src="{{static_url("jquery")}}"></script>
	<script type="text/javascript" src="{{static_url("jquery.jqprint.js")}}"></script>
<script type="text/javascript">
	var hkey_root,hkey_path,hkey_key;
		hkey_root="HKEY_CURRENT_USER";
		<!--地址的写法很严格的用双斜杠-->
		hkey_path="\\Software\\Microsoft\\Internet Explorer\\PageSetup\\";
	//设置网页打印的页眉页脚为空
	function pagesetup_null(){
	try{
		var RegWsh = new ActiveXObject("WScript.Shell");
		hkey_key="header";
		RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"");
		hkey_key="footer";
		RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"");
		hkey_key = "margin_top";
        RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"0");
        hkey_key = "margin_bottom";
        RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"0");
        hkey_key = "margin_left";
        RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"0");
        hkey_key = "margin_right";
        RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"0");
		}catch(e){}
}
function PageSetup_Default()
	{
	try{
		var RegWsh = new ActiveXObject( "WScript.Shell ") ;
		hkey_key= "header " ;
		RegWsh.RegWrite(hkey_root+hkey_path+hkey_key, "&w&b页码，&p/&P ") ;
		hkey_key= "footer " ;
		RegWsh.RegWrite(hkey_root+hkey_path+hkey_key, "&u&b&d ") ;
}
catch(e){}
} 
function printviewer(){
pagesetup_null();
wb.ExecWB(7,1);
PageSetup_Default();
}
</script>

<script type="text/javascript">
$(document).ready(	 
	 function setprintcss(){
	 	var boxarry=new Array();
	 	boxarry=[
	 		{'发件方':[['客户号码','2.8','0.5','1.6','3.1']
	 		,['始发地','4.8','0.5','4.5','3.1']
	 		,['公司名称','6.5','1.2','2.8','3.8']
	 		,['地址','6.5','2.0','2.8','5.2']
	 		,['寄件人签名','5.0','0.5','4.0','7.5']
	 		,['电话','7.0','0.5','2.3','8.3']
	 		,['委托货物内容','6.0','0.5','3.0','9.0']
	 		,['备注','6.3','0.5','2.8','9.8']]
	 		}
	 		,{'收件方':[['目的地','3.0','0.5','9.4','3.1']
	 		,['日期','4.4','0.5','12.4','3.1']
	 		,['公司名称','6.5','1.2','10.5','3.8']
	 		,['地址','6.5','2.0','10.5','5.2']
	 		,['收件人','6.5','0.5','10.2','7.5']
	 		,['电话','7.0','0.5','10.0','8.3']
	 		,['体积重量','6.5','0.5','10.5','9.0']]
	 		}
	 		,{'其他':[['件数','4.8','0.7','17.5','4.7']
	 		,['重量','4.8','0.7','19.5','4.7']
	 		,['非货样','0.4','0.4','17.1','5.6']
	 		,['现付','0.4','0.4','19.0','5.6']
	 		,['货样','0.4','0.4','17.1','6.4']
	 		,['月结','0.4','0.4','19.0','6.4']
	 		,['速递','0.4','0.4','17.1','7.1']
	 		,['到付','0.4','0.4','19.0','7.1']
	 		,['空运','0.4','0.4','17.1','7.9']
	 		,['总计','0.4','0.4','19.0','7.9']]
	 		}
	 		];
		var screenx=screen.width;
		var screeny=screen.height;
		var name,wid,hei,lef,top;

		// alert(boxarry['其他']);
		for(key in boxarry){

			for (key0 in boxarry[key]){
				for (var i=0;i<boxarry[key][key0].length;i++){		
					sname=key0;	
					name=boxarry[key][key0][i][0];
					wid=boxarry[key][key0][i][1]/0.026458+'px';
					hei=boxarry[key][key0][i][2]/0.026458+'px';
					lef=boxarry[key][key0][i][3]/0.026458 +4+'px'; 
					top=boxarry[key][key0][i][4]/0.026458 +2+'px';

					$("."+sname + " "+"." +name).css("width",wid);
					$("." +sname + " "+"." +name).css("height",hei);	
					$("." +sname + " "+"." +name).css("left",lef);	
					$("." +sname + " "+"." +name).css("top",top);
					$("." +sname + " "+"." +name).css("position","absolute");
							
				}
			}
		}
		wid=23.2/0.026458 -2+'px';
		hei=12.87/0.026458+'px';

		$("."+{{mingchen}}).css("width",wid);
		$("."+{{mingchen}}).css("height",hei);

	}	
);
</script>

<style media="print">
	<!--
	.noprint{display:none;}
	.pagenext{page-break-after:always;}
	-->
</style>

</head>
<body>
<!--  <div class="print">
	<input id="printclick" type="button" value="打印" />
</div> 
 -->
 <div class="print">
 	<object classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2" id="WB" name="wb" height="0px" width="0px"></object>

<!--  	<input id="printclick" class="noprint" type="button" value="打印" onclick="pagesetup_null();document.all.wb.ExecWB(6,1)" /> -->

 	<input type="button" class="noprint" value="打印" onclick="printviewer()" />
 	<input type="button" class="noprint" value="页面设置" onclick="document.all.wb.ExecWB(8,1)" />
</div> 

<div class="print_detail"> 

<!-- {{printdata}} <br/>-->

<!-- ({发件方:{客户号码:tt,始发地:ttt,}},{收件方:{目的地:tt,日期:ttt;}}
,{发件方:{客户号码:tt,始发地:ttt,}},{收件方:{目的地:tt,日期:ttt;}}
,{其他:{bei:tt}}
) -->

{%set fajianfang=tuple(xiangmu[0]['发件方'])%}
{%set shoujianfang=xiangmu[1]['收件方']%}
{%set dagou=list(xiangmu[3]['打勾'])%}
{%set qita=tuple(xiangmu[2]['其他'])%}
{%set relation=xiangmu[4]['relation']%}
<a id="test" href=""></a>

	{% for line in printdata %}
<div class="{{mingchen}}" ><img class="noprint" src="/static/image/{{mingchen}}.jpg">
	<ul class="发件方">
		{%for lline,vaule in line['发件方'].items()%}
		{%if vaule !=" "%}
			{%if lline in fajianfang %}
				{%if  lline in relation%}
					{%set relationtmp=relation[lline]%}
					{%if relationtmp not in qita%}	
						<!-- add to qita -->						
						{%set line['其他'][relationtmp] =vaule%}
					{%else%}
						{%set del line['其他'][relationtmp]%}	
						{%set line['其他'][relationtmp] =vaule%}
					{%end%}			
				{%end%}		
				<li class="{{lline}}">{{vaule}}</li>			
			{%else %}
				<label>未知的列名:{{lline}}</label>
			{%end%}
		{%end%}
		{%end%}	
	</ul>
	<ul class="收件方">
		{%for lline,vaule in line['收件方'].items()%}
		{%if vaule !=" "%}
			{%if lline in shoujianfang %}
				{%if  lline in relation%}
					{%set relationtmp=relation[lline]%}
					{%if relationtmp not in qita%}	
						<!-- add to qita -->						
						{%set line['其他'][relationtmp] =vaule%}
					{%else%}
						{%set del line['其他'][relationtmp]%}	
						{%set line['其他'][relationtmp] =vaule%}
					{%end%}			
				{%end%}		
				<li class="{{lline}}">{{vaule}}</li>			
			{%else %}
				<label>未知的列名:{{lline}}</label>
			{%end%}
		{%end%}
		{%end%}
	</ul>
	<ul class="其他">
		{%for lline,vaule in line['其他'].items()%}	
		{%if vaule !=" "%}	
			{%if lline in qita and lline in dagou %}
				<li class="{{lline}}">✔</li>				
			{%else%}
				<li class="{{lline}}">{{vaule}}</li>				
			{%end%}
		{%end%}
		{%end%}
	</ul>
</div>
	{%end%}


<!-- 发件方,客户号码,始发地,公司名称,地址,寄件人签名,电话,委托货物内容,备注,承运人 -->
</div>

</body>
</html>
